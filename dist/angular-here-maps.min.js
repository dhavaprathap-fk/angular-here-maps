"use strict";angular.module("angular-here-maps",[]),angular.module("angular-here-maps").directive("map",["MapConfig",function(MapConfig){return{template:'<div class="here-map"><ng-transclude></ng-transclude></div>',replace:!0,scope:{zoom:"=",center:"="},restrict:"EA",transclude:!0,controller:function($scope,$element){var defaultLayers,modules,ui,behavior;MapConfig.libraries()&&(modules=MapConfig.libraries().split(","));var platform=new H.service.Platform({app_id:MapConfig.appId(),app_code:MapConfig.appCode(),ppi:640});defaultLayers=platform.createDefaultLayers();var map=new H.Map($element[0],defaultLayers.normal.map);$scope.zoom&&map.setZoom($scope.zoom),$scope.center&&map.setCenter($scope.center),window.addEventListener("resize",function(){map.getViewPort().resize()}),_.each(modules,function(module){"ui"===module&&(ui=H.ui.UI.createDefault(map,defaultLayers)),"pano"===module&&platform.configure(H.map.render.panorama.RenderEngine),"mapevents"===module&&(behavior=new H.mapevents.Behavior(new H.mapevents.MapEvents(map)))})}}}]),angular.module("angular-here-maps").directive("marker",function(){return{require:"^map",scope:{coordinates:"=",icon:"=",radius:"="},template:"<div>dsfdsf</div>",link:function(scope,element,attrs,mapController){var addDotToMap=function(){if(scope.icon&&"dom"===scope.icon.type){var dot=document.createElement(scope.icon.element);dot.className=scope.icon.className;var icon=new H.map.DomIcon(dot),marker=new H.map.DomMarker(scope.coordinates,{icon:icon});mapController.map.addObject(marker)}},addCircleToMap=function(){return mapController.map.addObject(new H.map.Circle({lat:scope.coordinates.lat,lng:scope.coordinates.lng},scope.radius,{style:{strokeColor:"rgb(0, 37, 102)",lineWidth:2,fillColor:"rgba(0, 37, 102, 0.05)"}}))},addCurrentMarker=function(){scope.coordinates&&(scope.radius&&addCircleToMap(),addDotToMap())};scope.$watch("coordinates",function(){addCurrentMarker()})}}}),angular.module("angular-here-maps").provider("MapConfig",function(){this.mapOptions={},this.$get=function(){var mapOptions=this.mapOptions;return{appId:function(appId){return mapOptions.appId||appId},appCode:function(appCode){return mapOptions.appCode||appCode},libraries:function(libraries){return mapOptions.libraries||libraries}}},this.setOptions=function(options){this.mapOptions=options}});